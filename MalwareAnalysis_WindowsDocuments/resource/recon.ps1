$outfile = "$([Environment]::GetFolderPath('MyDocuments'))\system_info.txt"

$user = [Environment]::UserName
$domain = [Environment]::UserDomainName
"Current user: $user" | Out-File -FilePath $outfile -Append
"Current domain: $domain" | Out-File -FilePath $outfile -Append

"List of users:" | Out-File -FilePath $outfile -Append
Get-WmiObject -Class Win32_UserAccount | Select-Object Name, Domain, SID | Out-File -FilePath $outfile -Append

"System Information:" | Out-File -FilePath $outfile -Append
Get-WmiObject -Class Win32_ComputerSystem | Select-Object UserName, Domain, Manufacturer, Model, NumberOfProcessors, SystemType, TotalPhysicalMemory | Out-File -FilePath $outfile -Append

"Additional System Information:" | Out-File -FilePath $outfile -Append
systeminfo | Out-File -FilePath $outfile -Append

"Whoami:" | Out-File -FilePath $outfile -Append
whoami | Out-File -FilePath $outfile -Append
